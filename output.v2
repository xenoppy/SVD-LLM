[Sat 07 Jun 2025 05:46:58 PM UTC] Step 1: Start data whitening with 20% compression ratio
Start SVD decomposition after whitening...
[Sat 07 Jun 2025 06:12:02 PM UTC] Step 1: Finished data whitening
[Sat 07 Jun 2025 06:12:02 PM UTC] Step 2: Start SVD compression (step 4)
evaluating jeffwan_llama_7b_hf_whitening_only_0.8.pt...
[Sat 07 Jun 2025 06:12:37 PM UTC] Step 2: Finished SVD compression (step 4)
[Sat 07 Jun 2025 06:12:37 PM UTC] Step 3: Start LoRA finetune (first half)
trainable params: 14390272 || all params: 5456929792 || trainable%: 0.2637063797503224
{'loss': 1.8835, 'learning_rate': 0.0, 'epoch': 0.0}
{'loss': 1.9457, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.01}
{'loss': 1.9358, 'learning_rate': 1.8e-05, 'epoch': 0.03}
{'loss': 1.8503, 'learning_rate': 2.7000000000000002e-05, 'epoch': 0.04}
{'loss': 1.8331, 'learning_rate': 3.7e-05, 'epoch': 0.05}
{'loss': 1.8213, 'learning_rate': 4.7e-05, 'epoch': 0.06}
{'loss': 1.7697, 'learning_rate': 5.6999999999999996e-05, 'epoch': 0.08}
{'loss': 1.7083, 'learning_rate': 6.7e-05, 'epoch': 0.09}
{'loss': 1.6093, 'learning_rate': 7.7e-05, 'epoch': 0.1}
{'loss': 1.5282, 'learning_rate': 8.7e-05, 'epoch': 0.12}
{'loss': 1.4812, 'learning_rate': 9.7e-05, 'epoch': 0.13}
{'eval_yahma/alpaca-cleaned_loss': 1.445642352104187, 'eval_yahma/alpaca-cleaned_runtime': 75.1123, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.627, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.328, 'epoch': 0.13}
{'loss': 1.4497, 'learning_rate': 9.968623935454953e-05, 'epoch': 0.14}
{'loss': 1.3859, 'learning_rate': 9.923800986104887e-05, 'epoch': 0.15}
{'loss': 1.3743, 'learning_rate': 9.878978036754819e-05, 'epoch': 0.17}
{'loss': 1.3387, 'learning_rate': 9.834155087404752e-05, 'epoch': 0.18}
{'loss': 1.3399, 'learning_rate': 9.789332138054684e-05, 'epoch': 0.19}
{'loss': 1.3137, 'learning_rate': 9.744509188704618e-05, 'epoch': 0.21}
{'loss': 1.2987, 'learning_rate': 9.69968623935455e-05, 'epoch': 0.22}
{'loss': 1.2707, 'learning_rate': 9.654863290004483e-05, 'epoch': 0.23}
{'loss': 1.3035, 'learning_rate': 9.610040340654416e-05, 'epoch': 0.24}
{'loss': 1.281, 'learning_rate': 9.565217391304348e-05, 'epoch': 0.26}
{'eval_yahma/alpaca-cleaned_loss': 1.281975507736206, 'eval_yahma/alpaca-cleaned_runtime': 75.1544, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.612, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.326, 'epoch': 0.26}
{'loss': 1.2799, 'learning_rate': 9.520394441954282e-05, 'epoch': 0.27}
{'loss': 1.2484, 'learning_rate': 9.475571492604214e-05, 'epoch': 0.28}
{'loss': 1.2568, 'learning_rate': 9.430748543254147e-05, 'epoch': 0.3}
{'loss': 1.2524, 'learning_rate': 9.385925593904079e-05, 'epoch': 0.31}
{'loss': 1.2432, 'learning_rate': 9.341102644554011e-05, 'epoch': 0.32}
{'loss': 1.261, 'learning_rate': 9.296279695203944e-05, 'epoch': 0.33}
{'loss': 1.2814, 'learning_rate': 9.251456745853878e-05, 'epoch': 0.35}
{'loss': 1.2406, 'learning_rate': 9.206633796503811e-05, 'epoch': 0.36}
{'loss': 1.2513, 'learning_rate': 9.161810847153743e-05, 'epoch': 0.37}
{'loss': 1.2212, 'learning_rate': 9.116987897803677e-05, 'epoch': 0.39}
{'eval_yahma/alpaca-cleaned_loss': 1.238753080368042, 'eval_yahma/alpaca-cleaned_runtime': 75.1529, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.612, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.327, 'epoch': 0.39}
{'loss': 1.2416, 'learning_rate': 9.072164948453609e-05, 'epoch': 0.4}
{'loss': 1.2264, 'learning_rate': 9.02734199910354e-05, 'epoch': 0.41}
{'loss': 1.2193, 'learning_rate': 8.982519049753474e-05, 'epoch': 0.42}
{'loss': 1.2123, 'learning_rate': 8.937696100403406e-05, 'epoch': 0.44}
{'loss': 1.2121, 'learning_rate': 8.892873151053341e-05, 'epoch': 0.45}
{'loss': 1.2157, 'learning_rate': 8.848050201703273e-05, 'epoch': 0.46}
{'loss': 1.1961, 'learning_rate': 8.803227252353206e-05, 'epoch': 0.48}
{'loss': 1.1948, 'learning_rate': 8.758404303003138e-05, 'epoch': 0.49}
{'loss': 1.1887, 'learning_rate': 8.71358135365307e-05, 'epoch': 0.5}
{'loss': 1.2091, 'learning_rate': 8.668758404303004e-05, 'epoch': 0.51}
{'eval_yahma/alpaca-cleaned_loss': 1.2150163650512695, 'eval_yahma/alpaca-cleaned_runtime': 75.1307, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.62, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.328, 'epoch': 0.51}
{'loss': 1.2188, 'learning_rate': 8.623935454952936e-05, 'epoch': 0.53}
{'loss': 1.2073, 'learning_rate': 8.579112505602869e-05, 'epoch': 0.54}
{'loss': 1.2458, 'learning_rate': 8.534289556252801e-05, 'epoch': 0.55}
{'loss': 1.1937, 'learning_rate': 8.489466606902736e-05, 'epoch': 0.57}
{'loss': 1.2054, 'learning_rate': 8.444643657552668e-05, 'epoch': 0.58}
{'loss': 1.19, 'learning_rate': 8.3998207082026e-05, 'epoch': 0.59}
{'loss': 1.2151, 'learning_rate': 8.354997758852533e-05, 'epoch': 0.6}
{'loss': 1.193, 'learning_rate': 8.310174809502465e-05, 'epoch': 0.62}
{'loss': 1.1936, 'learning_rate': 8.265351860152398e-05, 'epoch': 0.63}
{'loss': 1.1978, 'learning_rate': 8.22052891080233e-05, 'epoch': 0.64}
{'eval_yahma/alpaca-cleaned_loss': 1.1996653079986572, 'eval_yahma/alpaca-cleaned_runtime': 75.1913, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.599, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.325, 'epoch': 0.64}
{'loss': 1.2039, 'learning_rate': 8.175705961452264e-05, 'epoch': 0.66}
{'loss': 1.1838, 'learning_rate': 8.130883012102196e-05, 'epoch': 0.67}
{'loss': 1.1884, 'learning_rate': 8.086060062752129e-05, 'epoch': 0.68}
{'loss': 1.1789, 'learning_rate': 8.041237113402063e-05, 'epoch': 0.69}
{'loss': 1.1947, 'learning_rate': 7.996414164051995e-05, 'epoch': 0.71}
{'loss': 1.1995, 'learning_rate': 7.951591214701928e-05, 'epoch': 0.72}
{'loss': 1.1721, 'learning_rate': 7.90676826535186e-05, 'epoch': 0.73}
{'loss': 1.1662, 'learning_rate': 7.861945316001793e-05, 'epoch': 0.75}
{'loss': 1.1737, 'learning_rate': 7.817122366651725e-05, 'epoch': 0.76}
{'loss': 1.1683, 'learning_rate': 7.772299417301659e-05, 'epoch': 0.77}
{'eval_yahma/alpaca-cleaned_loss': 1.1893696784973145, 'eval_yahma/alpaca-cleaned_runtime': 75.1801, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.603, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.325, 'epoch': 0.77}
{'loss': 1.1705, 'learning_rate': 7.727476467951592e-05, 'epoch': 0.78}
{'loss': 1.1809, 'learning_rate': 7.682653518601524e-05, 'epoch': 0.8}
{'loss': 1.1746, 'learning_rate': 7.637830569251458e-05, 'epoch': 0.81}
{'loss': 1.1603, 'learning_rate': 7.59300761990139e-05, 'epoch': 0.82}
{'loss': 1.1609, 'learning_rate': 7.548184670551323e-05, 'epoch': 0.84}
{'loss': 1.1638, 'learning_rate': 7.503361721201255e-05, 'epoch': 0.85}
{'loss': 1.184, 'learning_rate': 7.458538771851188e-05, 'epoch': 0.86}
{'loss': 1.1758, 'learning_rate': 7.41371582250112e-05, 'epoch': 0.87}
{'loss': 1.1887, 'learning_rate': 7.368892873151054e-05, 'epoch': 0.89}
{'loss': 1.1736, 'learning_rate': 7.324069923800987e-05, 'epoch': 0.9}
{'eval_yahma/alpaca-cleaned_loss': 1.1793898344039917, 'eval_yahma/alpaca-cleaned_runtime': 75.1997, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.596, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.324, 'epoch': 0.9}
{'loss': 1.1766, 'learning_rate': 7.279246974450919e-05, 'epoch': 0.91}
{'loss': 1.1411, 'learning_rate': 7.234424025100852e-05, 'epoch': 0.93}
{'loss': 1.1565, 'learning_rate': 7.189601075750784e-05, 'epoch': 0.94}
{'loss': 1.1791, 'learning_rate': 7.144778126400718e-05, 'epoch': 0.95}
{'loss': 1.1477, 'learning_rate': 7.09995517705065e-05, 'epoch': 0.96}
{'loss': 1.1747, 'learning_rate': 7.055132227700583e-05, 'epoch': 0.98}
{'loss': 1.1867, 'learning_rate': 7.010309278350515e-05, 'epoch': 0.99}
{'loss': 1.1761, 'learning_rate': 6.965486329000449e-05, 'epoch': 1.0}
{'loss': 1.1398, 'learning_rate': 6.920663379650382e-05, 'epoch': 1.02}
{'loss': 1.1279, 'learning_rate': 6.875840430300314e-05, 'epoch': 1.03}
{'eval_yahma/alpaca-cleaned_loss': 1.1727761030197144, 'eval_yahma/alpaca-cleaned_runtime': 75.2062, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.594, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.324, 'epoch': 1.03}
{'loss': 1.1247, 'learning_rate': 6.831017480950247e-05, 'epoch': 1.04}
{'loss': 1.1472, 'learning_rate': 6.78619453160018e-05, 'epoch': 1.05}
{'loss': 1.1293, 'learning_rate': 6.741371582250113e-05, 'epoch': 1.07}
{'loss': 1.1517, 'learning_rate': 6.696548632900045e-05, 'epoch': 1.08}
{'loss': 1.1539, 'learning_rate': 6.651725683549978e-05, 'epoch': 1.09}
{'loss': 1.1468, 'learning_rate': 6.60690273419991e-05, 'epoch': 1.11}
{'loss': 1.1525, 'learning_rate': 6.562079784849843e-05, 'epoch': 1.12}
{'loss': 1.1358, 'learning_rate': 6.517256835499777e-05, 'epoch': 1.13}
{'loss': 1.1489, 'learning_rate': 6.472433886149709e-05, 'epoch': 1.14}
{'loss': 1.1479, 'learning_rate': 6.427610936799642e-05, 'epoch': 1.16}
{'eval_yahma/alpaca-cleaned_loss': 1.16757333278656, 'eval_yahma/alpaca-cleaned_runtime': 75.1678, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.607, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.326, 'epoch': 1.16}
{'loss': 1.1236, 'learning_rate': 6.382787987449574e-05, 'epoch': 1.17}
{'loss': 1.1484, 'learning_rate': 6.337965038099508e-05, 'epoch': 1.18}
{'loss': 1.1393, 'learning_rate': 6.29314208874944e-05, 'epoch': 1.2}
{'loss': 1.1476, 'learning_rate': 6.248319139399372e-05, 'epoch': 1.21}
{'loss': 1.1461, 'learning_rate': 6.203496190049306e-05, 'epoch': 1.22}
{'loss': 1.1603, 'learning_rate': 6.158673240699238e-05, 'epoch': 1.23}
{'loss': 1.1158, 'learning_rate': 6.113850291349172e-05, 'epoch': 1.25}
{'loss': 1.1389, 'learning_rate': 6.069027341999104e-05, 'epoch': 1.26}
{'loss': 1.1541, 'learning_rate': 6.0242043926490365e-05, 'epoch': 1.27}
{'loss': 1.1131, 'learning_rate': 5.979381443298969e-05, 'epoch': 1.29}
{'eval_yahma/alpaca-cleaned_loss': 1.1623331308364868, 'eval_yahma/alpaca-cleaned_runtime': 75.0946, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.633, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.329, 'epoch': 1.29}
{'loss': 1.1137, 'learning_rate': 5.934558493948902e-05, 'epoch': 1.3}
{'loss': 1.1302, 'learning_rate': 5.8897355445988346e-05, 'epoch': 1.31}
{'loss': 1.1383, 'learning_rate': 5.844912595248767e-05, 'epoch': 1.32}
{'loss': 1.1415, 'learning_rate': 5.8000896458987006e-05, 'epoch': 1.34}
{'loss': 1.1454, 'learning_rate': 5.755266696548633e-05, 'epoch': 1.35}
{'loss': 1.1317, 'learning_rate': 5.710443747198566e-05, 'epoch': 1.36}
{'loss': 1.1466, 'learning_rate': 5.665620797848499e-05, 'epoch': 1.38}
{'loss': 1.142, 'learning_rate': 5.6207978484984314e-05, 'epoch': 1.39}
{'loss': 1.1428, 'learning_rate': 5.575974899148364e-05, 'epoch': 1.4}
{'loss': 1.118, 'learning_rate': 5.531151949798297e-05, 'epoch': 1.41}
{'eval_yahma/alpaca-cleaned_loss': 1.15803861618042, 'eval_yahma/alpaca-cleaned_runtime': 75.1621, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.609, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.326, 'epoch': 1.41}
{'loss': 1.1322, 'learning_rate': 5.4863290004482295e-05, 'epoch': 1.43}
{'loss': 1.1299, 'learning_rate': 5.441506051098163e-05, 'epoch': 1.44}
{'loss': 1.1447, 'learning_rate': 5.3966831017480955e-05, 'epoch': 1.45}
{'loss': 1.129, 'learning_rate': 5.351860152398028e-05, 'epoch': 1.47}
{'loss': 1.1411, 'learning_rate': 5.307037203047961e-05, 'epoch': 1.48}
{'loss': 1.139, 'learning_rate': 5.2622142536978936e-05, 'epoch': 1.49}
{'loss': 1.1248, 'learning_rate': 5.217391304347826e-05, 'epoch': 1.5}
{'loss': 1.1445, 'learning_rate': 5.172568354997759e-05, 'epoch': 1.52}
{'loss': 1.1044, 'learning_rate': 5.127745405647692e-05, 'epoch': 1.53}
{'loss': 1.139, 'learning_rate': 5.0829224562976244e-05, 'epoch': 1.54}
{'eval_yahma/alpaca-cleaned_loss': 1.1551071405410767, 'eval_yahma/alpaca-cleaned_runtime': 75.1125, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.627, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.328, 'epoch': 1.54}
{'loss': 1.1279, 'learning_rate': 5.038099506947558e-05, 'epoch': 1.56}
{'loss': 1.1323, 'learning_rate': 4.99327655759749e-05, 'epoch': 1.57}
{'loss': 1.1319, 'learning_rate': 4.948453608247423e-05, 'epoch': 1.58}
{'loss': 1.1108, 'learning_rate': 4.903630658897356e-05, 'epoch': 1.59}
{'loss': 1.1342, 'learning_rate': 4.8588077095472885e-05, 'epoch': 1.61}
{'loss': 1.1259, 'learning_rate': 4.813984760197221e-05, 'epoch': 1.62}
{'loss': 1.1353, 'learning_rate': 4.769161810847154e-05, 'epoch': 1.63}
{'loss': 1.1253, 'learning_rate': 4.7243388614970866e-05, 'epoch': 1.65}
{'loss': 1.1183, 'learning_rate': 4.679515912147019e-05, 'epoch': 1.66}
{'loss': 1.1453, 'learning_rate': 4.634692962796952e-05, 'epoch': 1.67}
{'eval_yahma/alpaca-cleaned_loss': 1.152642846107483, 'eval_yahma/alpaca-cleaned_runtime': 75.1922, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.599, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.325, 'epoch': 1.67}
{'loss': 1.1242, 'learning_rate': 4.5898700134468854e-05, 'epoch': 1.68}
{'loss': 1.118, 'learning_rate': 4.545047064096818e-05, 'epoch': 1.7}
{'loss': 1.1182, 'learning_rate': 4.500224114746751e-05, 'epoch': 1.71}
{'loss': 1.1258, 'learning_rate': 4.4554011653966834e-05, 'epoch': 1.72}
{'loss': 1.1355, 'learning_rate': 4.410578216046616e-05, 'epoch': 1.74}
{'loss': 1.1164, 'learning_rate': 4.365755266696549e-05, 'epoch': 1.75}
{'loss': 1.1276, 'learning_rate': 4.3209323173464815e-05, 'epoch': 1.76}
{'loss': 1.1314, 'learning_rate': 4.276109367996414e-05, 'epoch': 1.77}
{'loss': 1.1132, 'learning_rate': 4.231286418646347e-05, 'epoch': 1.79}
{'loss': 1.1276, 'learning_rate': 4.18646346929628e-05, 'epoch': 1.8}
{'eval_yahma/alpaca-cleaned_loss': 1.14970064163208, 'eval_yahma/alpaca-cleaned_runtime': 75.162, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.609, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.326, 'epoch': 1.8}
{'loss': 1.1555, 'learning_rate': 4.141640519946213e-05, 'epoch': 1.81}
{'loss': 1.1561, 'learning_rate': 4.0968175705961457e-05, 'epoch': 1.83}
{'loss': 1.1355, 'learning_rate': 4.051994621246078e-05, 'epoch': 1.84}
{'loss': 1.1244, 'learning_rate': 4.007171671896011e-05, 'epoch': 1.85}
{'loss': 1.1222, 'learning_rate': 3.962348722545944e-05, 'epoch': 1.86}
{'loss': 1.1485, 'learning_rate': 3.9175257731958764e-05, 'epoch': 1.88}
{'loss': 1.1344, 'learning_rate': 3.872702823845809e-05, 'epoch': 1.89}
{'loss': 1.12, 'learning_rate': 3.8278798744957425e-05, 'epoch': 1.9}
{'loss': 1.1077, 'learning_rate': 3.783056925145675e-05, 'epoch': 1.92}
{'loss': 1.1309, 'learning_rate': 3.738233975795607e-05, 'epoch': 1.93}
{'eval_yahma/alpaca-cleaned_loss': 1.1475002765655518, 'eval_yahma/alpaca-cleaned_runtime': 75.1186, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.625, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.328, 'epoch': 1.93}
{'loss': 1.1266, 'learning_rate': 3.69341102644554e-05, 'epoch': 1.94}
{'loss': 1.1168, 'learning_rate': 3.6485880770954726e-05, 'epoch': 1.95}
{'loss': 1.113, 'learning_rate': 3.603765127745406e-05, 'epoch': 1.97}
{'loss': 1.0978, 'learning_rate': 3.5589421783953386e-05, 'epoch': 1.98}
{'loss': 1.1397, 'learning_rate': 3.5141192290452713e-05, 'epoch': 1.99}
{'loss': 1.1224, 'learning_rate': 3.469296279695204e-05, 'epoch': 2.01}
{'loss': 1.1178, 'learning_rate': 3.4244733303451374e-05, 'epoch': 2.02}
{'loss': 1.1143, 'learning_rate': 3.3796503809950694e-05, 'epoch': 2.03}
{'loss': 1.1203, 'learning_rate': 3.334827431645002e-05, 'epoch': 2.05}
{'loss': 1.0854, 'learning_rate': 3.290004482294935e-05, 'epoch': 2.06}
{'eval_yahma/alpaca-cleaned_loss': 1.1470500230789185, 'eval_yahma/alpaca-cleaned_runtime': 75.1748, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.605, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.326, 'epoch': 2.06}
{'loss': 1.0899, 'learning_rate': 3.245181532944868e-05, 'epoch': 2.07}
{'loss': 1.1068, 'learning_rate': 3.200358583594801e-05, 'epoch': 2.08}
{'loss': 1.1094, 'learning_rate': 3.1555356342447336e-05, 'epoch': 2.1}
{'loss': 1.094, 'learning_rate': 3.110712684894666e-05, 'epoch': 2.11}
{'loss': 1.1024, 'learning_rate': 3.065889735544599e-05, 'epoch': 2.12}
{'loss': 1.1135, 'learning_rate': 3.021066786194532e-05, 'epoch': 2.14}
{'loss': 1.1051, 'learning_rate': 2.9762438368444647e-05, 'epoch': 2.15}
{'loss': 1.1104, 'learning_rate': 2.931420887494397e-05, 'epoch': 2.16}
{'loss': 1.1176, 'learning_rate': 2.8865979381443297e-05, 'epoch': 2.17}
{'loss': 1.1163, 'learning_rate': 2.841774988794263e-05, 'epoch': 2.19}
{'eval_yahma/alpaca-cleaned_loss': 1.146030306816101, 'eval_yahma/alpaca-cleaned_runtime': 75.2272, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.586, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.323, 'epoch': 2.19}
{'loss': 1.0936, 'learning_rate': 2.7969520394441954e-05, 'epoch': 2.2}
{'loss': 1.111, 'learning_rate': 2.752129090094128e-05, 'epoch': 2.21}
{'loss': 1.0854, 'learning_rate': 2.7073061407440608e-05, 'epoch': 2.23}
{'loss': 1.1275, 'learning_rate': 2.6624831913939942e-05, 'epoch': 2.24}
{'loss': 1.1319, 'learning_rate': 2.6176602420439265e-05, 'epoch': 2.25}
{'loss': 1.11, 'learning_rate': 2.5728372926938592e-05, 'epoch': 2.26}
{'loss': 1.0848, 'learning_rate': 2.528014343343792e-05, 'epoch': 2.28}
{'loss': 1.1037, 'learning_rate': 2.483191393993725e-05, 'epoch': 2.29}
{'loss': 1.0936, 'learning_rate': 2.4383684446436577e-05, 'epoch': 2.3}
{'loss': 1.085, 'learning_rate': 2.3935454952935903e-05, 'epoch': 2.32}
{'eval_yahma/alpaca-cleaned_loss': 1.1445573568344116, 'eval_yahma/alpaca-cleaned_runtime': 75.1137, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.626, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.328, 'epoch': 2.32}
{'loss': 1.0987, 'learning_rate': 2.3487225459435234e-05, 'epoch': 2.33}
{'loss': 1.0859, 'learning_rate': 2.303899596593456e-05, 'epoch': 2.34}
{'loss': 1.1238, 'learning_rate': 2.2590766472433888e-05, 'epoch': 2.35}
{'loss': 1.1053, 'learning_rate': 2.2142536978933215e-05, 'epoch': 2.37}
{'loss': 1.1212, 'learning_rate': 2.169430748543254e-05, 'epoch': 2.38}
{'loss': 1.1055, 'learning_rate': 2.1246077991931872e-05, 'epoch': 2.39}
{'loss': 1.069, 'learning_rate': 2.0797848498431195e-05, 'epoch': 2.41}
{'loss': 1.1124, 'learning_rate': 2.0349619004930526e-05, 'epoch': 2.42}
{'loss': 1.1253, 'learning_rate': 1.9901389511429853e-05, 'epoch': 2.43}
{'loss': 1.0951, 'learning_rate': 1.945316001792918e-05, 'epoch': 2.44}
{'eval_yahma/alpaca-cleaned_loss': 1.1429340839385986, 'eval_yahma/alpaca-cleaned_runtime': 75.1297, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.621, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.328, 'epoch': 2.44}
{'loss': 1.0996, 'learning_rate': 1.9004930524428506e-05, 'epoch': 2.46}
{'loss': 1.0995, 'learning_rate': 1.8556701030927837e-05, 'epoch': 2.47}
{'loss': 1.0727, 'learning_rate': 1.8108471537427164e-05, 'epoch': 2.48}
{'loss': 1.1014, 'learning_rate': 1.766024204392649e-05, 'epoch': 2.5}
{'loss': 1.0918, 'learning_rate': 1.7212012550425818e-05, 'epoch': 2.51}
{'loss': 1.0955, 'learning_rate': 1.6763783056925148e-05, 'epoch': 2.52}
{'loss': 1.1159, 'learning_rate': 1.6315553563424475e-05, 'epoch': 2.53}
{'loss': 1.1051, 'learning_rate': 1.5867324069923802e-05, 'epoch': 2.55}
{'loss': 1.1198, 'learning_rate': 1.541909457642313e-05, 'epoch': 2.56}
{'loss': 1.13, 'learning_rate': 1.4970865082922459e-05, 'epoch': 2.57}
{'eval_yahma/alpaca-cleaned_loss': 1.1418797969818115, 'eval_yahma/alpaca-cleaned_runtime': 75.1693, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.607, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.326, 'epoch': 2.57}
{'loss': 1.1017, 'learning_rate': 1.4522635589421784e-05, 'epoch': 2.59}
{'loss': 1.0802, 'learning_rate': 1.4074406095921111e-05, 'epoch': 2.6}
{'loss': 1.1085, 'learning_rate': 1.362617660242044e-05, 'epoch': 2.61}
{'loss': 1.1122, 'learning_rate': 1.3177947108919767e-05, 'epoch': 2.62}
{'loss': 1.119, 'learning_rate': 1.2729717615419095e-05, 'epoch': 2.64}
{'loss': 1.111, 'learning_rate': 1.2281488121918424e-05, 'epoch': 2.65}
{'loss': 1.1012, 'learning_rate': 1.183325862841775e-05, 'epoch': 2.66}
{'loss': 1.0976, 'learning_rate': 1.138502913491708e-05, 'epoch': 2.68}
{'loss': 1.1046, 'learning_rate': 1.0936799641416405e-05, 'epoch': 2.69}
{'loss': 1.1343, 'learning_rate': 1.0488570147915733e-05, 'epoch': 2.7}
{'eval_yahma/alpaca-cleaned_loss': 1.141480565071106, 'eval_yahma/alpaca-cleaned_runtime': 75.1303, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.62, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.328, 'epoch': 2.7}
{'loss': 1.1051, 'learning_rate': 1.004034065441506e-05, 'epoch': 2.71}
{'loss': 1.1154, 'learning_rate': 9.592111160914389e-06, 'epoch': 2.73}
{'loss': 1.1059, 'learning_rate': 9.143881667413716e-06, 'epoch': 2.74}
{'loss': 1.1061, 'learning_rate': 8.695652173913044e-06, 'epoch': 2.75}
{'loss': 1.1081, 'learning_rate': 8.247422680412371e-06, 'epoch': 2.77}
{'loss': 1.0956, 'learning_rate': 7.799193186911698e-06, 'epoch': 2.78}
{'loss': 1.0924, 'learning_rate': 7.350963693411027e-06, 'epoch': 2.79}
{'loss': 1.1123, 'learning_rate': 6.902734199910355e-06, 'epoch': 2.8}
{'loss': 1.093, 'learning_rate': 6.4545047064096824e-06, 'epoch': 2.82}
{'loss': 1.0887, 'learning_rate': 6.00627521290901e-06, 'epoch': 2.83}
{'eval_yahma/alpaca-cleaned_loss': 1.1411505937576294, 'eval_yahma/alpaca-cleaned_runtime': 75.2123, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.591, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.324, 'epoch': 2.83}
{'loss': 1.1155, 'learning_rate': 5.558045719408338e-06, 'epoch': 2.84}
{'loss': 1.1233, 'learning_rate': 5.109816225907665e-06, 'epoch': 2.86}
{'loss': 1.0963, 'learning_rate': 4.661586732406993e-06, 'epoch': 2.87}
{'loss': 1.1118, 'learning_rate': 4.2133572389063205e-06, 'epoch': 2.88}
{'loss': 1.1121, 'learning_rate': 3.765127745405648e-06, 'epoch': 2.89}
{'loss': 1.0803, 'learning_rate': 3.3168982519049756e-06, 'epoch': 2.91}
{'loss': 1.0886, 'learning_rate': 2.8686687584043033e-06, 'epoch': 2.92}
{'loss': 1.106, 'learning_rate': 2.4204392649036307e-06, 'epoch': 2.93}
{'loss': 1.0668, 'learning_rate': 1.9722097714029585e-06, 'epoch': 2.95}
{'loss': 1.1143, 'learning_rate': 1.523980277902286e-06, 'epoch': 2.96}
{'eval_yahma/alpaca-cleaned_loss': 1.1409120559692383, 'eval_yahma/alpaca-cleaned_runtime': 75.2544, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.577, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.322, 'epoch': 2.96}
{'loss': 1.1055, 'learning_rate': 1.0757507844016136e-06, 'epoch': 2.97}
{'loss': 1.1091, 'learning_rate': 6.275212909009413e-07, 'epoch': 2.98}
{'loss': 1.0822, 'learning_rate': 1.7929179740026896e-07, 'epoch': 3.0}
{'train_runtime': 14782.4214, 'train_samples_per_second': 10.098, 'train_steps_per_second': 0.158, 'train_loss': 1.1751060151890182, 'epoch': 3.0}
[Sat 07 Jun 2025 10:21:26 PM UTC] Step 3: Finished LoRA finetune (first half)
[Sat 07 Jun 2025 10:21:26 PM UTC] Step 4: Start merge LoRA (first half)
evaluating jeffwan_llama_7b_hf_whitening_only_0.8.pt...
Config:  LoraConfig(peft_type='LORA', base_model_name_or_path='jeffwan/llama-7b-hf', task_type='CAUSAL_LM', inference_mode=True, r=8, target_modules=['q_u_proj', 'k_u_proj', 'v_u_proj', 'o_u_proj', 'gate_u_proj', 'down_u_proj', 'up_u_proj'], lora_alpha=16, lora_dropout=0.05, fan_in_fan_out=False, bias='none', modules_to_save=None, init_lora_weights=True)
adapter_model.bin
[Sat 07 Jun 2025 10:23:20 PM UTC] Step 4: Finished merge LoRA (first half)
[Sat 07 Jun 2025 10:23:20 PM UTC] Step 5: Start LoRA finetune (second half)
trainable params: 12620800 || all params: 5455160320 || trainable%: 0.2313552537352376
{'loss': 1.105, 'learning_rate': 1.0000000000000002e-06, 'epoch': 0.0}
{'loss': 1.0693, 'learning_rate': 1e-05, 'epoch': 0.01}
{'loss': 1.0863, 'learning_rate': 2e-05, 'epoch': 0.03}
{'loss': 1.0935, 'learning_rate': 3e-05, 'epoch': 0.04}
{'loss': 1.0876, 'learning_rate': 4e-05, 'epoch': 0.05}
{'loss': 1.0881, 'learning_rate': 5e-05, 'epoch': 0.06}
{'loss': 1.0966, 'learning_rate': 6e-05, 'epoch': 0.08}
{'loss': 1.0923, 'learning_rate': 7e-05, 'epoch': 0.09}
{'loss': 1.1057, 'learning_rate': 8e-05, 'epoch': 0.1}
{'loss': 1.1009, 'learning_rate': 9e-05, 'epoch': 0.12}
{'loss': 1.1025, 'learning_rate': 0.0001, 'epoch': 0.13}
{'eval_yahma/alpaca-cleaned_loss': 1.1429678201675415, 'eval_yahma/alpaca-cleaned_runtime': 75.84, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.371, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.296, 'epoch': 0.13}
{'loss': 1.1063, 'learning_rate': 9.955177050649932e-05, 'epoch': 0.14}
{'loss': 1.1002, 'learning_rate': 9.910354101299866e-05, 'epoch': 0.15}
{'loss': 1.1004, 'learning_rate': 9.865531151949798e-05, 'epoch': 0.17}
{'loss': 1.0996, 'learning_rate': 9.820708202599731e-05, 'epoch': 0.18}
{'loss': 1.0961, 'learning_rate': 9.775885253249665e-05, 'epoch': 0.19}
{'loss': 1.0988, 'learning_rate': 9.731062303899598e-05, 'epoch': 0.21}
{'loss': 1.1052, 'learning_rate': 9.68623935454953e-05, 'epoch': 0.22}
{'loss': 1.1053, 'learning_rate': 9.641416405199462e-05, 'epoch': 0.23}
{'loss': 1.0831, 'learning_rate': 9.596593455849395e-05, 'epoch': 0.24}
{'loss': 1.1169, 'learning_rate': 9.551770506499327e-05, 'epoch': 0.26}
{'eval_yahma/alpaca-cleaned_loss': 1.1393486261367798, 'eval_yahma/alpaca-cleaned_runtime': 75.6983, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.421, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.303, 'epoch': 0.26}
{'loss': 1.0784, 'learning_rate': 9.506947557149261e-05, 'epoch': 0.27}
{'loss': 1.1018, 'learning_rate': 9.462124607799193e-05, 'epoch': 0.28}
{'loss': 1.0997, 'learning_rate': 9.430748543254147e-05, 'epoch': 0.3}
{'loss': 1.0921, 'learning_rate': 9.385925593904079e-05, 'epoch': 0.31}
{'loss': 1.111, 'learning_rate': 9.341102644554011e-05, 'epoch': 0.32}
{'loss': 1.109, 'learning_rate': 9.296279695203944e-05, 'epoch': 0.33}
{'loss': 1.0885, 'learning_rate': 9.251456745853878e-05, 'epoch': 0.35}
{'loss': 1.1122, 'learning_rate': 9.206633796503811e-05, 'epoch': 0.36}
{'loss': 1.0749, 'learning_rate': 9.161810847153743e-05, 'epoch': 0.37}
{'loss': 1.0739, 'learning_rate': 9.116987897803677e-05, 'epoch': 0.39}
{'eval_yahma/alpaca-cleaned_loss': 1.1356991529464722, 'eval_yahma/alpaca-cleaned_runtime': 75.6056, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.453, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.307, 'epoch': 0.39}
{'loss': 1.1172, 'learning_rate': 9.072164948453609e-05, 'epoch': 0.4}
{'loss': 1.0896, 'learning_rate': 9.02734199910354e-05, 'epoch': 0.41}
{'loss': 1.1127, 'learning_rate': 8.982519049753474e-05, 'epoch': 0.42}
{'loss': 1.0984, 'learning_rate': 8.937696100403406e-05, 'epoch': 0.44}
{'loss': 1.099, 'learning_rate': 8.892873151053341e-05, 'epoch': 0.45}
{'loss': 1.0903, 'learning_rate': 8.848050201703273e-05, 'epoch': 0.46}
{'loss': 1.0946, 'learning_rate': 8.803227252353206e-05, 'epoch': 0.48}
{'loss': 1.1138, 'learning_rate': 8.758404303003138e-05, 'epoch': 0.49}
{'loss': 1.1051, 'learning_rate': 8.71358135365307e-05, 'epoch': 0.5}
{'loss': 1.0827, 'learning_rate': 8.668758404303004e-05, 'epoch': 0.51}
{'eval_yahma/alpaca-cleaned_loss': 1.129116177558899, 'eval_yahma/alpaca-cleaned_runtime': 75.7057, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.418, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.302, 'epoch': 0.51}
{'loss': 1.0857, 'learning_rate': 8.623935454952936e-05, 'epoch': 0.53}
{'loss': 1.0908, 'learning_rate': 8.579112505602869e-05, 'epoch': 0.54}
{'loss': 1.083, 'learning_rate': 8.534289556252801e-05, 'epoch': 0.55}
{'loss': 1.0942, 'learning_rate': 8.489466606902736e-05, 'epoch': 0.57}
{'loss': 1.0973, 'learning_rate': 8.444643657552668e-05, 'epoch': 0.58}
{'loss': 1.0858, 'learning_rate': 8.3998207082026e-05, 'epoch': 0.59}
{'loss': 1.0622, 'learning_rate': 8.354997758852533e-05, 'epoch': 0.6}
{'loss': 1.0813, 'learning_rate': 8.310174809502465e-05, 'epoch': 0.62}
{'loss': 1.0897, 'learning_rate': 8.265351860152398e-05, 'epoch': 0.63}
{'loss': 1.1138, 'learning_rate': 8.22052891080233e-05, 'epoch': 0.64}
{'eval_yahma/alpaca-cleaned_loss': 1.1244165897369385, 'eval_yahma/alpaca-cleaned_runtime': 75.7922, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.388, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.298, 'epoch': 0.64}
{'loss': 1.0738, 'learning_rate': 8.175705961452264e-05, 'epoch': 0.66}
{'loss': 1.0622, 'learning_rate': 8.130883012102196e-05, 'epoch': 0.67}
{'loss': 1.0688, 'learning_rate': 8.086060062752129e-05, 'epoch': 0.68}
{'loss': 1.0898, 'learning_rate': 8.041237113402063e-05, 'epoch': 0.69}
{'loss': 1.0843, 'learning_rate': 7.996414164051995e-05, 'epoch': 0.71}
{'loss': 1.0725, 'learning_rate': 7.951591214701928e-05, 'epoch': 0.72}
{'loss': 1.1016, 'learning_rate': 7.90676826535186e-05, 'epoch': 0.73}
{'loss': 1.0886, 'learning_rate': 7.861945316001793e-05, 'epoch': 0.75}
{'loss': 1.0601, 'learning_rate': 7.817122366651725e-05, 'epoch': 0.76}
{'loss': 1.1091, 'learning_rate': 7.772299417301659e-05, 'epoch': 0.77}
{'eval_yahma/alpaca-cleaned_loss': 1.1203323602676392, 'eval_yahma/alpaca-cleaned_runtime': 75.7133, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.415, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.302, 'epoch': 0.77}
{'loss': 1.0924, 'learning_rate': 7.727476467951592e-05, 'epoch': 0.78}
{'loss': 1.0766, 'learning_rate': 7.682653518601524e-05, 'epoch': 0.8}
{'loss': 1.0908, 'learning_rate': 7.637830569251458e-05, 'epoch': 0.81}
{'loss': 1.0789, 'learning_rate': 7.59300761990139e-05, 'epoch': 0.82}
{'loss': 1.0959, 'learning_rate': 7.548184670551323e-05, 'epoch': 0.84}
{'loss': 1.0932, 'learning_rate': 7.503361721201255e-05, 'epoch': 0.85}
{'loss': 1.0603, 'learning_rate': 7.458538771851188e-05, 'epoch': 0.86}
{'loss': 1.0697, 'learning_rate': 7.41371582250112e-05, 'epoch': 0.87}
{'loss': 1.0666, 'learning_rate': 7.368892873151054e-05, 'epoch': 0.89}
{'loss': 1.0854, 'learning_rate': 7.324069923800987e-05, 'epoch': 0.9}
{'eval_yahma/alpaca-cleaned_loss': 1.116876244544983, 'eval_yahma/alpaca-cleaned_runtime': 75.7189, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.413, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.302, 'epoch': 0.9}
{'loss': 1.0744, 'learning_rate': 7.279246974450919e-05, 'epoch': 0.91}
{'loss': 1.0559, 'learning_rate': 7.234424025100852e-05, 'epoch': 0.93}
{'loss': 1.0772, 'learning_rate': 7.189601075750784e-05, 'epoch': 0.94}
{'loss': 1.0821, 'learning_rate': 7.144778126400718e-05, 'epoch': 0.95}
{'loss': 1.0651, 'learning_rate': 7.09995517705065e-05, 'epoch': 0.96}
{'loss': 1.0594, 'learning_rate': 7.055132227700583e-05, 'epoch': 0.98}
{'loss': 1.0865, 'learning_rate': 7.010309278350515e-05, 'epoch': 0.99}
{'loss': 1.0646, 'learning_rate': 6.965486329000449e-05, 'epoch': 1.0}
{'loss': 0.9856, 'learning_rate': 6.920663379650382e-05, 'epoch': 1.02}
{'loss': 0.9832, 'learning_rate': 6.875840430300314e-05, 'epoch': 1.03}
{'eval_yahma/alpaca-cleaned_loss': 1.1178886890411377, 'eval_yahma/alpaca-cleaned_runtime': 75.5723, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.465, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.308, 'epoch': 1.03}
{'loss': 0.9858, 'learning_rate': 6.831017480950247e-05, 'epoch': 1.04}
{'loss': 0.9696, 'learning_rate': 6.78619453160018e-05, 'epoch': 1.05}
{'loss': 0.9921, 'learning_rate': 6.741371582250113e-05, 'epoch': 1.07}
{'loss': 0.9852, 'learning_rate': 6.696548632900045e-05, 'epoch': 1.08}
{'loss': 1.001, 'learning_rate': 6.651725683549978e-05, 'epoch': 1.09}
{'loss': 1.0146, 'learning_rate': 6.60690273419991e-05, 'epoch': 1.11}
{'loss': 1.0101, 'learning_rate': 6.562079784849843e-05, 'epoch': 1.12}
{'loss': 1.0114, 'learning_rate': 6.517256835499777e-05, 'epoch': 1.13}
{'loss': 0.9941, 'learning_rate': 6.472433886149709e-05, 'epoch': 1.14}
{'loss': 0.9893, 'learning_rate': 6.427610936799642e-05, 'epoch': 1.16}
{'eval_yahma/alpaca-cleaned_loss': 1.1190894842147827, 'eval_yahma/alpaca-cleaned_runtime': 75.7466, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.404, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.3, 'epoch': 1.16}
{'loss': 1.0135, 'learning_rate': 6.382787987449574e-05, 'epoch': 1.17}
{'loss': 1.0255, 'learning_rate': 6.337965038099508e-05, 'epoch': 1.18}
{'loss': 0.9945, 'learning_rate': 6.29314208874944e-05, 'epoch': 1.2}
{'loss': 0.9974, 'learning_rate': 6.248319139399372e-05, 'epoch': 1.21}
{'loss': 0.9792, 'learning_rate': 6.203496190049306e-05, 'epoch': 1.22}
{'loss': 0.993, 'learning_rate': 6.158673240699238e-05, 'epoch': 1.23}
{'loss': 1.0176, 'learning_rate': 6.113850291349172e-05, 'epoch': 1.25}
{'loss': 0.979, 'learning_rate': 6.069027341999104e-05, 'epoch': 1.26}
{'loss': 0.9726, 'learning_rate': 6.0242043926490365e-05, 'epoch': 1.27}
{'loss': 1.0056, 'learning_rate': 5.979381443298969e-05, 'epoch': 1.29}
{'eval_yahma/alpaca-cleaned_loss': 1.1151460409164429, 'eval_yahma/alpaca-cleaned_runtime': 75.6888, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.424, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.303, 'epoch': 1.29}
{'loss': 0.9896, 'learning_rate': 5.934558493948902e-05, 'epoch': 1.3}
{'loss': 1.0051, 'learning_rate': 5.8897355445988346e-05, 'epoch': 1.31}
{'loss': 0.9767, 'learning_rate': 5.844912595248767e-05, 'epoch': 1.32}
{'loss': 1.0019, 'learning_rate': 5.8000896458987006e-05, 'epoch': 1.34}
{'loss': 0.9833, 'learning_rate': 5.755266696548633e-05, 'epoch': 1.35}
{'loss': 1.0134, 'learning_rate': 5.710443747198566e-05, 'epoch': 1.36}
{'loss': 0.9907, 'learning_rate': 5.665620797848499e-05, 'epoch': 1.38}
{'loss': 1.0052, 'learning_rate': 5.6207978484984314e-05, 'epoch': 1.39}
{'loss': 0.9735, 'learning_rate': 5.575974899148364e-05, 'epoch': 1.4}
{'loss': 1.0196, 'learning_rate': 5.531151949798297e-05, 'epoch': 1.41}
{'eval_yahma/alpaca-cleaned_loss': 1.1125872135162354, 'eval_yahma/alpaca-cleaned_runtime': 75.6819, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.426, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.303, 'epoch': 1.41}
{'loss': 0.9966, 'learning_rate': 5.4863290004482295e-05, 'epoch': 1.43}
{'loss': 0.9964, 'learning_rate': 5.441506051098163e-05, 'epoch': 1.44}
{'loss': 1.0252, 'learning_rate': 5.3966831017480955e-05, 'epoch': 1.45}
{'loss': 0.9884, 'learning_rate': 5.351860152398028e-05, 'epoch': 1.47}
{'loss': 0.9944, 'learning_rate': 5.307037203047961e-05, 'epoch': 1.48}
{'loss': 1.0032, 'learning_rate': 5.2622142536978936e-05, 'epoch': 1.49}
{'loss': 1.0184, 'learning_rate': 5.217391304347826e-05, 'epoch': 1.5}
{'loss': 0.9838, 'learning_rate': 5.172568354997759e-05, 'epoch': 1.52}
{'loss': 0.995, 'learning_rate': 5.127745405647692e-05, 'epoch': 1.53}
{'loss': 1.0045, 'learning_rate': 5.0829224562976244e-05, 'epoch': 1.54}
{'eval_yahma/alpaca-cleaned_loss': 1.113722801208496, 'eval_yahma/alpaca-cleaned_runtime': 75.7613, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.399, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.3, 'epoch': 1.54}
{'loss': 1.0206, 'learning_rate': 5.038099506947558e-05, 'epoch': 1.56}
{'loss': 0.9861, 'learning_rate': 4.99327655759749e-05, 'epoch': 1.57}
{'loss': 1.0004, 'learning_rate': 4.948453608247423e-05, 'epoch': 1.58}
{'loss': 1.003, 'learning_rate': 4.903630658897356e-05, 'epoch': 1.59}
{'loss': 0.9721, 'learning_rate': 4.8588077095472885e-05, 'epoch': 1.61}
{'loss': 0.9911, 'learning_rate': 4.813984760197221e-05, 'epoch': 1.62}
{'loss': 0.9762, 'learning_rate': 4.769161810847154e-05, 'epoch': 1.63}
{'loss': 0.9912, 'learning_rate': 4.7243388614970866e-05, 'epoch': 1.65}
{'loss': 1.0103, 'learning_rate': 4.679515912147019e-05, 'epoch': 1.66}
{'loss': 1.0307, 'learning_rate': 4.634692962796952e-05, 'epoch': 1.67}
{'eval_yahma/alpaca-cleaned_loss': 1.1095492839813232, 'eval_yahma/alpaca-cleaned_runtime': 75.5763, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.463, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.308, 'epoch': 1.67}
{'loss': 0.9894, 'learning_rate': 4.5898700134468854e-05, 'epoch': 1.68}
{'loss': 0.9825, 'learning_rate': 4.545047064096818e-05, 'epoch': 1.7}
{'loss': 0.9854, 'learning_rate': 4.500224114746751e-05, 'epoch': 1.71}
{'loss': 0.9923, 'learning_rate': 4.4554011653966834e-05, 'epoch': 1.72}
{'loss': 0.9899, 'learning_rate': 4.410578216046616e-05, 'epoch': 1.74}
{'loss': 0.9735, 'learning_rate': 4.365755266696549e-05, 'epoch': 1.75}
{'loss': 0.9969, 'learning_rate': 4.3209323173464815e-05, 'epoch': 1.76}
{'loss': 0.9799, 'learning_rate': 4.276109367996414e-05, 'epoch': 1.77}
{'loss': 1.0106, 'learning_rate': 4.231286418646347e-05, 'epoch': 1.79}
{'loss': 0.9965, 'learning_rate': 4.18646346929628e-05, 'epoch': 1.8}
{'eval_yahma/alpaca-cleaned_loss': 1.1093920469284058, 'eval_yahma/alpaca-cleaned_runtime': 75.7227, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.412, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.302, 'epoch': 1.8}
{'loss': 0.9616, 'learning_rate': 4.141640519946213e-05, 'epoch': 1.81}
{'loss': 0.9925, 'learning_rate': 4.0968175705961457e-05, 'epoch': 1.83}
{'loss': 0.9898, 'learning_rate': 4.051994621246078e-05, 'epoch': 1.84}
{'loss': 0.9831, 'learning_rate': 4.007171671896011e-05, 'epoch': 1.85}
{'loss': 1.0204, 'learning_rate': 3.962348722545944e-05, 'epoch': 1.86}
{'loss': 1.0021, 'learning_rate': 3.9175257731958764e-05, 'epoch': 1.88}
{'loss': 1.01, 'learning_rate': 3.872702823845809e-05, 'epoch': 1.89}
{'loss': 0.9893, 'learning_rate': 3.8278798744957425e-05, 'epoch': 1.9}
{'loss': 1.0077, 'learning_rate': 3.783056925145675e-05, 'epoch': 1.92}
{'loss': 0.994, 'learning_rate': 3.738233975795607e-05, 'epoch': 1.93}
{'eval_yahma/alpaca-cleaned_loss': 1.1072090864181519, 'eval_yahma/alpaca-cleaned_runtime': 75.6753, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.429, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.304, 'epoch': 1.93}
{'loss': 0.9694, 'learning_rate': 3.69341102644554e-05, 'epoch': 1.94}
{'loss': 0.988, 'learning_rate': 3.6485880770954726e-05, 'epoch': 1.95}
{'loss': 1.0123, 'learning_rate': 3.603765127745406e-05, 'epoch': 1.97}
{'loss': 1.0017, 'learning_rate': 3.5589421783953386e-05, 'epoch': 1.98}
{'loss': 0.979, 'learning_rate': 3.5141192290452713e-05, 'epoch': 1.99}
{'loss': 0.9373, 'learning_rate': 3.469296279695204e-05, 'epoch': 2.01}
{'loss': 0.9116, 'learning_rate': 3.4244733303451374e-05, 'epoch': 2.02}
{'loss': 0.9044, 'learning_rate': 3.3796503809950694e-05, 'epoch': 2.03}
{'loss': 0.9206, 'learning_rate': 3.334827431645002e-05, 'epoch': 2.05}
{'loss': 0.9198, 'learning_rate': 3.290004482294935e-05, 'epoch': 2.06}
{'eval_yahma/alpaca-cleaned_loss': 1.1163984537124634, 'eval_yahma/alpaca-cleaned_runtime': 75.7014, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.42, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.302, 'epoch': 2.06}
{'loss': 0.9219, 'learning_rate': 3.245181532944868e-05, 'epoch': 2.07}
{'loss': 0.9137, 'learning_rate': 3.200358583594801e-05, 'epoch': 2.08}
{'loss': 0.8975, 'learning_rate': 3.1555356342447336e-05, 'epoch': 2.1}
{'loss': 0.9268, 'learning_rate': 3.110712684894666e-05, 'epoch': 2.11}
{'loss': 0.8921, 'learning_rate': 3.065889735544599e-05, 'epoch': 2.12}
{'loss': 0.9334, 'learning_rate': 3.021066786194532e-05, 'epoch': 2.14}
{'loss': 0.9238, 'learning_rate': 2.9762438368444647e-05, 'epoch': 2.15}
{'loss': 0.8982, 'learning_rate': 2.931420887494397e-05, 'epoch': 2.16}
{'loss': 0.9159, 'learning_rate': 2.8865979381443297e-05, 'epoch': 2.17}
{'loss': 0.9069, 'learning_rate': 2.841774988794263e-05, 'epoch': 2.19}
{'eval_yahma/alpaca-cleaned_loss': 1.122752070426941, 'eval_yahma/alpaca-cleaned_runtime': 75.6783, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.428, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.303, 'epoch': 2.19}
{'loss': 0.8845, 'learning_rate': 2.7969520394441954e-05, 'epoch': 2.2}
{'loss': 0.8885, 'learning_rate': 2.752129090094128e-05, 'epoch': 2.21}
{'loss': 0.911, 'learning_rate': 2.7073061407440608e-05, 'epoch': 2.23}
{'loss': 0.9058, 'learning_rate': 2.6624831913939942e-05, 'epoch': 2.24}
{'loss': 0.9269, 'learning_rate': 2.6176602420439265e-05, 'epoch': 2.25}
{'loss': 0.9089, 'learning_rate': 2.5728372926938592e-05, 'epoch': 2.26}
{'loss': 0.9022, 'learning_rate': 2.528014343343792e-05, 'epoch': 2.28}
{'loss': 0.9082, 'learning_rate': 2.483191393993725e-05, 'epoch': 2.29}
{'loss': 0.9049, 'learning_rate': 2.4383684446436577e-05, 'epoch': 2.3}
{'loss': 0.9159, 'learning_rate': 2.3935454952935903e-05, 'epoch': 2.32}
{'eval_yahma/alpaca-cleaned_loss': 1.1201308965682983, 'eval_yahma/alpaca-cleaned_runtime': 75.731, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.409, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.301, 'epoch': 2.32}
{'loss': 0.9255, 'learning_rate': 2.3487225459435234e-05, 'epoch': 2.33}
{'loss': 0.927, 'learning_rate': 2.303899596593456e-05, 'epoch': 2.34}
{'loss': 0.9129, 'learning_rate': 2.2590766472433888e-05, 'epoch': 2.35}
{'loss': 0.8987, 'learning_rate': 2.2142536978933215e-05, 'epoch': 2.37}
{'loss': 0.9122, 'learning_rate': 2.169430748543254e-05, 'epoch': 2.38}
{'loss': 0.8946, 'learning_rate': 2.1246077991931872e-05, 'epoch': 2.39}
{'loss': 0.8975, 'learning_rate': 2.0797848498431195e-05, 'epoch': 2.41}
{'loss': 0.9005, 'learning_rate': 2.0349619004930526e-05, 'epoch': 2.42}
{'loss': 0.9169, 'learning_rate': 1.9901389511429853e-05, 'epoch': 2.43}
{'loss': 0.9329, 'learning_rate': 1.945316001792918e-05, 'epoch': 2.44}
{'eval_yahma/alpaca-cleaned_loss': 1.1209075450897217, 'eval_yahma/alpaca-cleaned_runtime': 75.7265, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.411, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.301, 'epoch': 2.44}
{'loss': 0.8995, 'learning_rate': 1.9004930524428506e-05, 'epoch': 2.46}
{'loss': 0.9229, 'learning_rate': 1.8556701030927837e-05, 'epoch': 2.47}
{'loss': 0.9061, 'learning_rate': 1.8108471537427164e-05, 'epoch': 2.48}
{'loss': 0.9319, 'learning_rate': 1.766024204392649e-05, 'epoch': 2.5}
{'loss': 0.9179, 'learning_rate': 1.7212012550425818e-05, 'epoch': 2.51}
{'loss': 0.8848, 'learning_rate': 1.6763783056925148e-05, 'epoch': 2.52}
{'loss': 0.892, 'learning_rate': 1.6315553563424475e-05, 'epoch': 2.53}
{'loss': 0.9256, 'learning_rate': 1.5867324069923802e-05, 'epoch': 2.55}
{'loss': 0.9118, 'learning_rate': 1.541909457642313e-05, 'epoch': 2.56}
{'loss': 0.8818, 'learning_rate': 1.4970865082922459e-05, 'epoch': 2.57}
{'eval_yahma/alpaca-cleaned_loss': 1.1211708784103394, 'eval_yahma/alpaca-cleaned_runtime': 75.7211, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.413, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.302, 'epoch': 2.57}
{'loss': 0.9128, 'learning_rate': 1.4522635589421784e-05, 'epoch': 2.59}
{'loss': 0.9059, 'learning_rate': 1.4074406095921111e-05, 'epoch': 2.6}
{'loss': 0.9238, 'learning_rate': 1.362617660242044e-05, 'epoch': 2.61}
{'loss': 0.9301, 'learning_rate': 1.3177947108919767e-05, 'epoch': 2.62}
{'loss': 0.9034, 'learning_rate': 1.2729717615419095e-05, 'epoch': 2.64}
{'loss': 0.9057, 'learning_rate': 1.2281488121918424e-05, 'epoch': 2.65}
{'loss': 0.9132, 'learning_rate': 1.183325862841775e-05, 'epoch': 2.66}
{'loss': 0.9024, 'learning_rate': 1.138502913491708e-05, 'epoch': 2.68}
{'loss': 0.9193, 'learning_rate': 1.0936799641416405e-05, 'epoch': 2.69}
{'loss': 0.9129, 'learning_rate': 1.0488570147915733e-05, 'epoch': 2.7}
{'eval_yahma/alpaca-cleaned_loss': 1.1185866594314575, 'eval_yahma/alpaca-cleaned_runtime': 75.7302, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.41, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.301, 'epoch': 2.7}
{'loss': 0.9282, 'learning_rate': 1.004034065441506e-05, 'epoch': 2.71}
{'loss': 0.9015, 'learning_rate': 9.592111160914389e-06, 'epoch': 2.73}
{'loss': 0.9106, 'learning_rate': 9.143881667413716e-06, 'epoch': 2.74}
{'loss': 0.8985, 'learning_rate': 8.695652173913044e-06, 'epoch': 2.75}
{'loss': 0.9087, 'learning_rate': 8.247422680412371e-06, 'epoch': 2.77}
{'loss': 0.9065, 'learning_rate': 7.799193186911698e-06, 'epoch': 2.78}
{'loss': 0.9153, 'learning_rate': 7.350963693411027e-06, 'epoch': 2.79}
{'loss': 0.907, 'learning_rate': 6.902734199910355e-06, 'epoch': 2.8}
{'loss': 0.9184, 'learning_rate': 6.4545047064096824e-06, 'epoch': 2.82}
{'loss': 0.9044, 'learning_rate': 6.00627521290901e-06, 'epoch': 2.83}
{'eval_yahma/alpaca-cleaned_loss': 1.1187219619750977, 'eval_yahma/alpaca-cleaned_runtime': 75.7095, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.417, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.302, 'epoch': 2.83}
{'loss': 0.9185, 'learning_rate': 5.558045719408338e-06, 'epoch': 2.84}
{'loss': 0.9209, 'learning_rate': 5.109816225907665e-06, 'epoch': 2.86}
{'loss': 0.8991, 'learning_rate': 4.661586732406993e-06, 'epoch': 2.87}
{'loss': 0.9053, 'learning_rate': 4.2133572389063205e-06, 'epoch': 2.88}
{'loss': 0.9176, 'learning_rate': 3.765127745405648e-06, 'epoch': 2.89}
{'loss': 0.913, 'learning_rate': 3.3168982519049756e-06, 'epoch': 2.91}
{'loss': 0.9077, 'learning_rate': 2.8686687584043033e-06, 'epoch': 2.92}
{'loss': 0.909, 'learning_rate': 2.4204392649036307e-06, 'epoch': 2.93}
{'loss': 0.8793, 'learning_rate': 1.9722097714029585e-06, 'epoch': 2.95}
{'loss': 0.9265, 'learning_rate': 1.523980277902286e-06, 'epoch': 2.96}
{'eval_yahma/alpaca-cleaned_loss': 1.119192123413086, 'eval_yahma/alpaca-cleaned_runtime': 75.7266, 'eval_yahma/alpaca-cleaned_samples_per_second': 26.411, 'eval_yahma/alpaca-cleaned_steps_per_second': 3.301, 'epoch': 2.96}
{'loss': 0.8986, 'learning_rate': 1.0757507844016136e-06, 'epoch': 2.97}
{'loss': 0.8995, 'learning_rate': 6.275212909009413e-07, 'epoch': 2.98}
{'loss': 0.8956, 'learning_rate': 1.7929179740026896e-07, 'epoch': 3.0}
{'train_runtime': 15336.6452, 'train_samples_per_second': 9.734, 'train_steps_per_second': 0.152, 'train_loss': 0.9981970928452752, 'epoch': 3.0}
[Sun 08 Jun 2025 02:41:15 AM UTC] Step 5: Finished LoRA finetune (second half)
[Sun 08 Jun 2025 02:41:15 AM UTC] Step 6: Start merge LoRA (second half, first merge)
evaluating jeffwan_llama_7b_hf_whitening_only_0.8.pt...
Config:  LoraConfig(peft_type='LORA', base_model_name_or_path='jeffwan/llama-7b-hf', task_type='CAUSAL_LM', inference_mode=True, r=8, target_modules=['q_u_proj', 'k_u_proj', 'v_u_proj', 'o_u_proj', 'gate_u_proj', 'down_u_proj', 'up_u_proj'], lora_alpha=16, lora_dropout=0.05, fan_in_fan_out=False, bias='none', modules_to_save=None, init_lora_weights=True)
adapter_model.bin
[Sun 08 Jun 2025 02:43:42 AM UTC] Step 6: Finished merge LoRA (second half, first merge)
[Sun 08 Jun 2025 02:43:42 AM UTC] Step 7: Start merge LoRA (second half, final merge)
evaluating ./first_half/merge.pt...
Config:  LoraConfig(peft_type='LORA', base_model_name_or_path='jeffwan/llama-7b-hf', task_type='CAUSAL_LM', inference_mode=True, r=8, target_modules=['q_v_proj', 'k_v_proj', 'v_v_proj', 'o_v_proj', 'gate_v_proj', 'down_v_proj', 'up_v_proj'], lora_alpha=16, lora_dropout=0.05, fan_in_fan_out=False, bias='none', modules_to_save=None, init_lora_weights=True)
adapter_model.bin
[Sun 08 Jun 2025 02:45:27 AM UTC] Step 7: Finished merge LoRA (second half, final merge)
